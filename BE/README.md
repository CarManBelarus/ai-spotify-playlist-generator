# AI Spotify генератар плэйлістоў

Праект на Google Apps Script, які выкарыстоўвае Google Gemini AI для аўтаматычнай генерацыі персаналізаваных плэйлістоў Spotify і стварэння для іх унікальных, згенераваных AI вокладак праз Hugging Face.

Скрыпт аналізуе вашу існуючую музычную бібліятэку з кэша бібліятэкі Goofy, знаходзіць новыя рэкамендацыі трэкаў з улікам вашых густаў і стварае карыстальніцкую вокладку, якая візуальна адлюстроўвае настрой плэйліста.

## Ключавыя магчымасці

-   **Рэкамендацыі на аснове AI:** Выкарыстоўвае мадэль Gemini AI для аналізу выбаркі з вашай музычнай бібліятэкі і генерацыі спісу новых рэкамендацый.
-   **Без ручнога экспарту:** Чытае вашы "Упадабаныя трэкі" непасрэдна з файла кэша (`SavedTracks.json`), які аўтаматычна падтрымліваецца бібліятэкай Goofy.
-   **Генерацыя вокладак праз Hugging Face:** Аўтаматычна стварае ўнікальную атмасферную вокладку для кожнага абнаўлення плэйліста, выкарыстоўваючы магутныя text-to-image мадэлі (напр., Juggernaut XL, Stable Diffusion 3).
-   **Разумнае кіраванне плэйлістом:** Надзейна абнаўляе мэтавы плэйліст: дадае новыя трэкі ў пачатак (захоўваючы даты дадання старых), а затым выдаляе самыя старыя, калі плэйліст перавышае зададзены памер.
-   **Аўтаматычная ачыстка:** Уключае асобную функцыю для выдалення трэкаў, якія вы нядаўна слухалі, падтрымліваючы свежасць плэйліста.
-   **Лёгкасць налады:** Усе ключавыя параметры, уключаючы выбар мадэлі для генерацыі вокладкі, канфігуруюцца ў верхняй частцы файла скрыпта.

---

## Інструкцыя па ўсталёўцы і наладзе

Гэта кіраўніцтва дапаможа вам наладзіць праект з нуля.

### Патрабаванні

-   Уліковы запіс Google (для Google Apps Script).
-   Уліковы запіс Spotify (рэкамендуецца Premium для поўнага доступу да API).
-   Уліковы запіс Hugging Face (бясплатны, для генерацыі вокладак).

---

### Частка 1: Пачатковая налада бібліятэкі Goofy

Гэты праект з'яўляецца дадаткам да магутнай бібліятэкі `goofy`. Яе правільная налада — самы важны крок.

1.  **Атрымайце беларускамоўную версію Goofy.**
    Гэты праект выкарыстоўвае адаптаваную беларускамоўную версію бібліятэкі `goofy`. Усе неабходныя файлы (`library.js`, `config.gs`) знаходзяцца ў асобным рэпазіторыі.
    -   **[Спампаваць беларускамоўную бібліятэку Goofy](https://github.com/CarManBelarus/goofy)**
    Скапіруйце змест гэтых файлаў. Яны спатрэбяцца вам на наступным кроку.

2.  **Выканайце афіцыйную інструкцыю па ўсталёўцы Goofy.**
    Цяпер, калі ў вас ёсць беларускамоўныя файлы, перайдзіце па спасылцы ніжэй і выканайце **ўсе крокі**, уключаючы падручнік "Першы плэйліст". **Важна:** калі інструкцыя прапануе скапіраваць код `library.js` ці `config.gs`, выкарыстоўвайце версіі, якія вы падрыхтавалі на папярэднім кроку.
    -   **[Афіцыйная інструкцыя па ўсталёўцы Goofy](https://chimildic.github.io/goofy/#/install)**

3.  **Што вы зробіце на гэтым этапе:**
    -   Створыце новы праект Google Apps Script з усімі неабходнымі файламі Goofy.
    -   Створыце праграму Spotify Developer, каб атрымаць `CLIENT_ID` і `CLIENT_SECRET`.
    -   Наладзіце файл `config.gs` вашага праекта (выкарыстоўваючы беларускую версію) і аўтарызуеце скрыпт.
    -   **Самае важнае: Goofy пачне ствараць файл `SavedTracks.json` у тэчцы `Goofy Data` на вашым Google Drive. Гэты файл неабходны для нашага скрыпта.**

4.  **Пачакайце, пакуль створыцца кэш.** Пасля першапачатковай налады Goofy патрабуецца некаторы час, каб стварыць поўны кэш вашых "Упадабаных трэкаў". Гэта можа заняць ад некалькіх гадзін да сутак, у залежнасці ад памеру вашай бібліятэкі. Вы можаце працягваць выконваць наступныя крокі, пакуль гэта адбываецца ў фонавым рэжыме.

---

### Частка 2: Збор ID і API-ключаў

Цяпер збярэм уліковыя даныя, неабходныя для нашага AI-скрыпта.

#### A. ID плэйліста Spotify (`SPOTIFY_PLAYLIST_ID`)

Гэта ID плэйліста, якім будзе кіраваць скрыпт. Можна выкарыстоўваць існуючы плэйліст або стварыць новы пусты.

1.  Адкрыйце Spotify.
2.  Знайдзіце або стварыце плэйліст, які хочаце выкарыстоўваць.
3.  Націсніце кнопку **`...`** (дадатковыя опцыі) побач з назвай плэйліста.
4.  Перайдзіце ў **Share** -> **Copy link to playlist**.
5.  Спасылка будзе выглядаць прыкладна так: `https://open.spotify.com/playlist/37i9dQZF1DXcBWXoPEoRv1?si=...`
6.  Ваш ID плэйліста — гэта радок сімвалаў паміж `playlist/` і `?`. У прыкладзе вышэй гэта `37i9dQZF1DXcBWXoPEoRv1`. **Скапіруйце гэты ID.**

#### B. API-ключ Google Gemini (`GEMINI_API_KEY`)

Гэта ваш асабісты ключ для доступу да мадэлі Gemini AI для аналізу музыкі.

1.  Перайдзіце ў **[Google AI Studio](https://aistudio.google.com/)**.
2.  Увайдзіце ў свой уліковы запіс Google.
3.  На левай панэлі націсніце **"Get API key"**.
4.  Націсніце кнопку **"Create API key in new project"**.
5.  Для вас будзе згенераваны новы API-ключ. **Скапіруйце гэты доўгі радок сімвалаў** і захавайце ў надзейным месцы.

#### C. API-ключ Hugging Face (`HUGGINGFACE_API_KEY`)

Гэта ваш ключ доступу да сэрвісу Hugging Face для генерацыі вокладак.

1.  Перайдзіце на сайт **[Hugging Face](https://huggingface.co/)** і зарэгіструйцеся або ўвайдзіце ва ўліковы запіс.
2.  Націсніце на свой аватар у правым верхнім куце і абярыце **Settings**.
3.  На левай панэлі перайдзіце ў раздзел **Access Tokens**.
4.  Націсніце кнопку **New token**.
5.  Дайце токену імя (напрыклад, `gas-spotify-covers`) і абярыце ролю (`Role`) **read**.
6.  Націсніце **Generate a token**. **Скапіруйце гэты токен** (ён пачынаецца з `hf_...`).

---

### Частка 3: Даданне і налада AI-скрыпта

Цяпер дадамо нашу AI-логіку ў ваш праект Goofy.

1.  **Стварыце новы файл для AI-скрыпта:**
    *   У вашым існуючым праекце Goofy націсніце на значок **`+`** побач з "Files" і абярыце **"Script"**.
    *   Назавіце новы файл **`AI_Плэйлісты`** і націсніце Enter.

2.  **Дадайце код AI-скрыпта:**
    *   Адкрыйце файл `AI_Плэйлісты.gs`, які вы толькі што стварылі.
    *   Скапіруйце ўвесь змест файла `AI_Плэйлісты.gs` з гэтага рэпазіторыя і ўстаўце ў ваш новы файл.

3.  **Наладзьце AI-скрыпт:**
    *   У файле `AI_Плэйлісты.gs`, які вы дадалі, знайдзіце блок `AI_CONFIG` у самым версе.
    *   Устаўце ID плэйліста, які вы атрымалі ў Частцы 2:
        ```javascript
        const AI_CONFIG = {
          SPOTIFY_PLAYLIST_ID: 'YOUR_SPOTIFY_PLAYLIST_ID_HERE', // <<<=== УСТАЎЦЕ ВАШ ID ПЛЭЙЛІСТА
          // ... іншыя налады ...
        };
        ```
    *   Праглядзіце іншыя налады ў `AI_CONFIG` (напрыклад, `SELECTED_MODEL_ID` для вокладкі) і адкарэктуйце іх пры неабходнасці.
    *   **Захавайце файл** (<kbd>Ctrl</kbd>+<kbd>S</kbd>).

---

### Частка 4: Фінальная канфігурацыя (Уласцівасці скрыпта і дакладная налада)

#### A. Дадайце вашы API-ключы

1.  У рэдактары Apps Script націсніце на **Налады праекта** (значок шасцярэнькі ⚙️) на левай бакавой панэлі.
2.  Пракруціце ўніз да раздзела **"Script Properties"** (Уласцівасці скрыпта).
3.  Націсніце **"Edit script properties"**, а затым **"Add script property"** два разы, каб дадаць два ключы:

    *   **Ключ 1 (Gemini):**
        *   **Property:** `GEMINI_API_KEY`
        *   **Value:** Устаўце ваш API-ключ Gemini, які вы скапіравалі раней.

    *   **Ключ 2 (Hugging Face):**
        *   **Property:** `HUGGINGFACE_API_KEY`
        *   **Value:** Устаўце ваш токен доступу Hugging Face (`hf_...`).

4.  Націсніце **"Save script properties"**.

#### B. Дакладная налада пошуку (Настойліва рэкамендуецца)

Для атрымання найлепшых вынікаў рэкамендуецца наладзіць адчувальнасць пошуку Goofy.

1.  Адкрыйце файл `config.gs` у вашым праекце.
2.  Дадайце наступны радок у функцыю `setProperties()`:
    ```javascript
    UserProperties.setProperty('MIN_DICE_RATING', '0.70');
    ```
3.  **Чаму?** Гэтая налада кантралюе, наколькі назва трэка ад AI павінна быць падобнай да выніку пошуку ў Spotify. Значэнне па змаўчанні — `0.6`. Больш высокае значэнне, такое як `0.70`, робіць пошук больш строгім і зніжае верагоднасць дадання няправільных трэкаў у ваш плэйліст.
4.  **Захавайце файл `config.gs`.**

---

### Частка 5: Запуск і аўтаматызацыя скрыпта

Усё гатова!

1.  **Выканайце тэст:**
    *   У рэдактары Apps Script пераканайцеся, што вы праглядаеце файл `AI_Плэйлісты.gs`.
    *   У выпадальным меню функцый уверсе абярыце `generateAndCreateSpotifyPlaylist`.
    *   Націсніце кнопку **"Run"**.
    *   Выкананне скрыпта зойме некалькі хвілін. Вы можаце сачыць за яго прагрэсам у "Execution log".
    *   У выпадку поспеху ваш плэйліст Spotify будзе абноўлены новымі трэкамі і новай, згенераванай AI вокладкай!

2.  **Наладзьце аўтаматызацыю (Трыгеры):**
    *   Каб скрыпт працаваў аўтаматычна, націсніце на **Трыгеры** (значок гадзінніка ⏰) на левай бакавой панэлі.
    *   Націсніце кнопку **"Add Trigger"**.

    **Трыгер 1: Штодзённая генерацыя плэйліста**
    *   **Choose which function to run:** `generateAndCreateSpotifyPlaylist`
    *   **Select event source:** `Time-driven`
    *   **Select type of time based trigger:** `Day timer`
    *   **Select time of day:** `4am to 5am` (ці любы іншы час, які вам падабаецца).
    *   Націсніце **"Save"**.

    **Трыгер 2: Штогадзінная ачыстка плэйліста (Апцыянальна)**
    *   Зноў націсніце **"Add Trigger"**.
    *   **Choose which function to run:** `cleanUpPlaylist`
    *   **Select event source:** `Time-driven`
    *   **Select type of time based trigger:** `Hour timer`
    *   **Select hour interval:** `Every hour`.
    *   Націсніце **"Save"**.
